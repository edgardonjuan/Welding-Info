<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Welding Practice & Study Tracker</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        color-scheme: dark;
        --bg: #05060a;
        --card: rgba(15, 24, 39, 0.86);
        --card-border: rgba(148, 163, 184, 0.12);
        --card-border-strong: rgba(148, 163, 184, 0.4);
        --accent: #38bdf8;
        --accent-soft: rgba(56, 189, 248, 0.12);
        --accent-strong: rgba(56, 189, 248, 0.6);
        --text: #f8fafc;
        --text-subtle: #94a3b8;
        --text-muted: #64748b;
        --shadow: 0 30px 60px -25px rgba(15, 118, 110, 0.35);
        font-size: 16px;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family:
          "Inter",
          system-ui,
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          sans-serif;
        background:
          radial-gradient(
            circle at 10% 10%,
            rgba(56, 189, 248, 0.09),
            transparent 50%
          ),
          radial-gradient(
            circle at 90% 0%,
            rgba(14, 165, 233, 0.18),
            transparent 45%
          ),
          linear-gradient(160deg, rgba(8, 47, 73, 0.6), transparent 65%),
          var(--bg);
        color: var(--text);
        min-height: 100vh;
      }

      header {
        position: sticky;
        top: 0;
        backdrop-filter: blur(16px);
        background: rgba(2, 6, 23, 0.75);
        border-bottom: 1px solid rgba(148, 163, 184, 0.08);
        padding: 1.25rem 0;
        z-index: 10;
      }

      .wrapper {
        width: min(1120px, 94vw);
        margin: 0 auto;
      }

      .top-bar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
      }

      .title {
        font-size: clamp(1.5rem, 2.4vw + 1rem, 2.75rem);
        font-weight: 800;
        letter-spacing: -0.02em;
      }

      nav {
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
        justify-content: flex-end;
      }

      nav a {
        color: var(--text-subtle);
        text-decoration: none;
        font-size: 0.95rem;
        font-weight: 600;
        padding: 0.55rem 0.95rem;
        border-radius: 999px;
        border: 1px solid transparent;
        transition: all 0.2s ease;
      }

      nav a:hover,
      nav a:focus {
        color: var(--text);
        border-color: var(--accent-strong);
        background: rgba(56, 189, 248, 0.08);
        outline: none;
      }

      main {
        padding: 3rem 0 4rem;
        display: grid;
        gap: 2.5rem;
      }

      section {
        display: grid;
        gap: 1.5rem;
      }

      h2 {
        font-size: clamp(1.35rem, 1.1vw + 1rem, 2rem);
        font-weight: 700;
      }

      p.lead {
        max-width: 56ch;
        color: var(--text-subtle);
        font-size: 1.05rem;
      }

      .cards {
        display: grid;
        gap: 1.25rem;
      }

      @media (min-width: 768px) {
        .cards.two {
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }

        .cards.three {
          grid-template-columns: repeat(3, minmax(0, 1fr));
        }
      }

      .card {
        background: var(--card);
        border-radius: 24px;
        padding: 1.75rem;
        border: 1px solid var(--card-border);
        box-shadow: var(--shadow);
        transition:
          border 0.2s ease,
          transform 0.2s ease;
      }

      .card:hover {
        border-color: var(--card-border-strong);
        transform: translateY(-2px);
      }

      .progress-ring {
        position: relative;
        display: grid;
        place-items: center;
        width: 140px;
        aspect-ratio: 1;
      }

      .progress-ring svg {
        transform: rotate(-90deg);
      }

      .progress-ring span {
        position: absolute;
        font-weight: 700;
        font-size: 1.35rem;
      }

      .tracker-list {
        display: grid;
        gap: 0.9rem;
      }

      .tracker-item {
        position: relative;
        display: grid;
        grid-template-columns: auto 1fr auto;
        gap: 1rem;
        align-items: flex-start;
        padding: 1rem 1.25rem;
        padding-right: 3rem;
        border-radius: 18px;
        background: rgba(15, 23, 42, 0.9);
        border: 1px solid rgba(148, 163, 184, 0.14);
        transition:
          border 0.2s ease,
          box-shadow 0.2s ease;
      }

      .tracker-item[data-state="done"] {
        border-color: rgba(56, 189, 248, 0.5);
        box-shadow: 0 16px 32px -20px rgba(56, 189, 248, 0.45);
      }

      .tracker-content {
        display: grid;
        gap: 0.35rem;
      }

      .tracker-content h3 {
        font-size: 1rem;
        font-weight: 600;
      }

      .tracker-content p {
        color: var(--text-muted);
        font-size: 0.9rem;
      }

      .tracker-item .tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.35rem;
      }

      .tracker-item .tag {
        padding: 0.25rem 0.65rem;
        border-radius: 999px;
        background: rgba(56, 189, 248, 0.16);
        color: var(--accent);
        font-size: 0.75rem;
        font-weight: 600;
        letter-spacing: 0.03em;
        text-transform: uppercase;
      }

      .badge {
        font-size: 0.75rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: var(--accent);
        background: rgba(56, 189, 248, 0.14);
        border-radius: 999px;
        padding: 0.35rem 0.7rem;
        font-weight: 600;
      }

      .remove-item {
        position: absolute;
        top: 0.65rem;
        right: 0.65rem;
        background: rgba(15, 23, 42, 0.6);
        border: 1px solid rgba(148, 163, 184, 0.4);
        border-radius: 999px;
        color: var(--text-subtle);
        width: 28px;
        height: 28px;
        display: grid;
        place-items: center;
        cursor: pointer;
        transition:
          color 0.2s ease,
          border 0.2s ease,
          background 0.2s ease;
      }

      .remove-item:hover,
      .remove-item:focus {
        color: var(--text);
        border-color: var(--accent-strong);
        background: rgba(56, 189, 248, 0.14);
        outline: none;
      }

      .toggle {
        --size: 22px;
        appearance: none;
        width: calc(var(--size) * 2.1);
        height: var(--size);
        border-radius: 999px;
        background: rgba(148, 163, 184, 0.24);
        border: 1px solid rgba(148, 163, 184, 0.45);
        position: relative;
        cursor: pointer;
        transition:
          background 0.2s ease,
          border 0.2s ease;
      }

      .toggle::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 4px;
        translate: 0 -50%;
        width: calc(var(--size) - 6px);
        aspect-ratio: 1;
        border-radius: 50%;
        background: var(--text-subtle);
        transition:
          transform 0.2s ease,
          background 0.2s ease;
        box-shadow: 0 3px 12px rgba(15, 23, 42, 0.45);
      }

      .toggle:checked {
        background: rgba(56, 189, 248, 0.28);
        border-color: var(--accent-strong);
      }

      .toggle:checked::after {
        transform: translateX(115%);
        background: var(--accent);
      }

      .resource-link {
        color: inherit;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
      }

      .resource-link span {
        font-size: 0.85rem;
        color: var(--accent);
      }

      .form-card {
        display: grid;
        gap: 1.2rem;
      }

      .field {
        display: grid;
        gap: 0.4rem;
      }

      .field label {
        font-size: 0.8rem;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        color: var(--text-subtle);
        font-weight: 600;
      }

      .field input,
      .field select,
      .field textarea {
        background: rgba(15, 23, 42, 0.7);
        border: 1px solid rgba(148, 163, 184, 0.25);
        border-radius: 12px;
        padding: 0.65rem 0.85rem;
        color: var(--text);
        font: inherit;
        resize: none;
      }

      .field textarea {
        resize: vertical;
        min-height: 120px;
      }

      .field input:focus,
      .field select:focus,
      .field textarea:focus {
        outline: none;
        border-color: var(--accent-strong);
        box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.25);
      }

      .field small {
        color: var(--text-muted);
        font-size: 0.75rem;
      }

      .form-error {
        color: #fca5a5;
        font-size: 0.85rem;
      }

      .form-actions {
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
      }

      .link-button {
        background: none;
        border: none;
        color: var(--text-muted);
        font: inherit;
        text-decoration: underline;
        cursor: pointer;
        padding: 0;
        align-self: flex-start;
      }

      .link-button:hover,
      .link-button:focus {
        color: var(--text);
        outline: none;
      }

      .custom-reading-list {
        list-style: none;
        display: grid;
        gap: 0.35rem;
        color: var(--text-subtle);
        font-size: 0.85rem;
      }

      .progress-bar {
        width: 100%;
        height: 8px;
        border-radius: 999px;
        background: rgba(15, 23, 42, 0.9);
        overflow: hidden;
      }

      .progress-bar span {
        display: block;
        height: 100%;
        background: linear-gradient(
          90deg,
          rgba(56, 189, 248, 0.2),
          rgba(56, 189, 248, 0.75)
        );
        transform-origin: left;
      }

      .notes-grid {
        align-items: start;
      }

      .notes-card form {
        display: grid;
        gap: 1.1rem;
        margin-top: 1.25rem;
      }

      .notes-card textarea {
        width: 100%;
        min-height: 160px;
        border-radius: 16px;
        border: 1px solid rgba(148, 163, 184, 0.25);
        background: rgba(2, 6, 23, 0.75);
        color: var(--text);
        padding: 1rem 1.2rem;
        font-size: 0.95rem;
        resize: vertical;
        transition: border 0.2s ease;
      }

      .notes-card textarea:focus {
        outline: none;
        border-color: rgba(56, 189, 248, 0.55);
        box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.45);
      }

      .notes-card button,
      .card button.primary {
        padding: 0.75rem 1.15rem;
        border-radius: 14px;
        border: none;
        font-weight: 600;
        color: var(--bg);
        background: linear-gradient(135deg, #22d3ee, #38bdf8 55%, #2563eb);
        cursor: pointer;
        transition:
          transform 0.2s ease,
          filter 0.2s ease;
      }

      .notes-card button:hover,
      .card button.primary:hover {
        transform: translateY(-1px);
        filter: brightness(1.05);
      }

      .notes-card button.secondary {
        background: transparent;
        color: var(--text-subtle);
        border: 1px solid rgba(148, 163, 184, 0.4);
      }

      .notes-card button.secondary:hover {
        color: var(--text);
        border-color: rgba(56, 189, 248, 0.5);
      }

      .notes-card .actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 0.75rem;
        margin-top: 0.5rem;
        flex-wrap: wrap;
      }

      .notes-card .actions button {
        flex: none;
      }

      .notes-history {
        display: grid;
        gap: 1rem;
      }

      .notes-list {
        list-style: none;
        display: grid;
        gap: 1rem;
        margin-top: 1rem;
      }

      .note-entry {
        background: rgba(15, 24, 39, 0.65);
        border-radius: 16px;
        border: 1px solid rgba(148, 163, 184, 0.12);
        padding: 1rem 1.1rem;
        display: grid;
        gap: 0.6rem;
      }

      .note-entry header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 0.75rem;
        flex-wrap: wrap;
      }

      .note-entry time {
        font-size: 0.85rem;
        color: var(--accent);
        font-weight: 600;
        letter-spacing: 0.02em;
      }

      .note-entry button {
        background: none;
        border: none;
        color: var(--text-subtle);
        font-size: 0.85rem;
        font-weight: 600;
        cursor: pointer;
        transition: color 0.2s ease;
      }

      .note-entry button:hover {
        color: var(--accent);
      }

      .note-entry p {
        font-size: 0.95rem;
        line-height: 1.55;
        white-space: pre-wrap;
      }

      .empty-message {
        font-size: 0.9rem;
        color: var(--text-muted);
        margin-top: 1rem;
        text-align: center;
      }

      footer {
        padding: 3rem 0 4rem;
        color: var(--text-muted);
        font-size: 0.85rem;
        text-align: center;
      }

      .flex-between {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1rem;
        flex-wrap: wrap;
      }

      .subtle {
        color: var(--text-muted);
        font-size: 0.9rem;
      }

      .reading-list {
        display: grid;
        gap: 1rem;
      }

      .reading-list article {
        padding: 1.35rem 1.5rem;
        border-radius: 20px;
        border: 1px solid rgba(148, 163, 184, 0.15);
        background: rgba(15, 23, 42, 0.88);
        display: grid;
        gap: 0.6rem;
      }

      .reading-list a {
        color: var(--text);
        font-weight: 600;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .reading-list a svg {
        width: 18px;
        height: 18px;
      }

      .reading-list a span {
        font-size: 0.85rem;
        color: var(--text-subtle);
        font-weight: 500;
      }

      .reading-list .tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.35rem;
      }

      .reading-list .tag {
        padding: 0.25rem 0.65rem;
        border-radius: 999px;
        background: rgba(56, 189, 248, 0.16);
        color: var(--accent);
        font-size: 0.75rem;
        font-weight: 600;
        letter-spacing: 0.06em;
      }

      .progress-summary {
        display: grid;
        gap: 1.5rem;
        align-items: start;
      }

      @media (min-width: 900px) {
        .progress-summary {
          grid-template-columns: auto 1fr;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="wrapper top-bar">
        <div>
          <div class="title">Welding Practice & Study Tracker</div>
          <p class="subtle">
            Stay accountable across reading, practice reps, and personal notes.
          </p>
        </div>
        <nav aria-label="Section navigation">
          <a href="#overview">Dashboard</a>
          <a href="#reading">Readings</a>
          <a href="#practice">Practice</a>
          <a href="#notes">Notes</a>
        </nav>
      </div>
    </header>

    <main class="wrapper">
      <section id="overview">
        <div class="progress-summary card">
          <div class="progress-ring" aria-hidden="true">
            <svg width="140" height="140" viewBox="0 0 120 120">
              <circle
                cx="60"
                cy="60"
                r="52"
                fill="none"
                stroke="rgba(148,163,184,0.2)"
                stroke-width="8"
              ></circle>
              <circle
                cx="60"
                cy="60"
                r="52"
                fill="none"
                stroke="var(--accent)"
                stroke-linecap="round"
                stroke-width="8"
                stroke-dasharray="327"
                stroke-dashoffset="327"
              ></circle>
            </svg>
            <span id="overall-percentage">0%</span>
          </div>
          <div>
            <h2>Weekly Momentum</h2>
            <p class="lead">
              Toggle each reading or practice block as you complete it. The
              tracker stores your progress locally so you can come back later
              and pick up right where you left off.
            </p>
            <div class="cards three" style="margin-top: 1.5rem">
              <div class="card" style="padding: 1.1rem 1.3rem">
                <div class="subtle">Reading Complete</div>
                <div class="flex-between" style="margin-top: 0.6rem">
                  <strong id="reading-count" style="font-size: 1.8rem"
                    >0%</strong
                  >
                  <div class="progress-bar" style="flex: 1; margin-left: 1rem">
                    <span id="reading-bar" style="width: 0%"></span>
                  </div>
                </div>
              </div>
              <div class="card" style="padding: 1.1rem 1.3rem">
                <div class="subtle">Practice Complete</div>
                <div class="flex-between" style="margin-top: 0.6rem">
                  <strong id="practice-count" style="font-size: 1.8rem"
                    >0%</strong
                  >
                  <div class="progress-bar" style="flex: 1; margin-left: 1rem">
                    <span id="practice-bar" style="width: 0%"></span>
                  </div>
                </div>
              </div>
              <div class="card" style="padding: 1.1rem 1.3rem">
                <div class="subtle">Streak</div>
                <div style="margin-top: 0.6rem">
                  <strong id="streak-count" style="font-size: 1.8rem"
                    >0 days</strong
                  >
                  <p class="subtle" style="margin-top: 0.35rem">
                    Longest streak saved locally.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="reading">
        <div class="flex-between">
          <h2>Reading Checklist</h2>
          <p class="subtle">
            Link new lessons, diagrams, or quizzes as you find them.
          </p>
        </div>
        <div class="cards two">
          <div class="card">
            <div class="tracker-list" id="reading-list"></div>
            <p class="empty-message" hidden>
              No readings match that filter yet.
            </p>
          </div>
          <div class="card form-card">
            <div>
              <h3 style="font-size: 1.1rem; font-weight: 700">
                Personalize your plan
              </h3>
              <p class="subtle" style="margin-top: 0.5rem">
                Save any article or video you like. We'll keep progress and
                links stored locally for you.
              </p>
            </div>
            <div class="field">
              <label for="reading-filter">Filter by topic</label>
              <select
                id="reading-filter"
                aria-label="Filter reading list by topic"
              >
                <option value="all">Show everything</option>
              </select>
            </div>
            <form id="add-reading-form" class="custom-reading-form" novalidate>
              <div class="field">
                <label for="reading-title">Title</label>
                <input
                  id="reading-title"
                  name="title"
                  type="text"
                  required
                  placeholder="e.g. GTAW Aluminum Settings"
                />
              </div>
              <div class="field">
                <label for="reading-link">Link</label>
                <input
                  id="reading-link"
                  name="link"
                  type="url"
                  required
                  placeholder="https://example.com/your-resource"
                />
                <small
                  >We'll open new links in a separate tab so you don't lose your
                  tracker.</small
                >
              </div>
              <div class="field">
                <label for="reading-description">What you'll cover</label>
                <textarea
                  id="reading-description"
                  name="description"
                  rows="3"
                  placeholder="Short note about the diagrams, safety tips, or quiz you'll study"
                ></textarea>
              </div>
              <div class="field">
                <label for="reading-category">Topic tag</label>
                <input
                  id="reading-category"
                  name="category"
                  type="text"
                  placeholder="e.g. safety, symbols, process"
                />
              </div>
              <p class="form-error" data-form-error hidden role="alert"></p>
              <button class="primary" type="submit">
                Add to reading checklist
              </button>
            </form>
            <div id="custom-reading-summary" hidden>
              <h4 style="font-size: 0.95rem; font-weight: 600">
                Your custom lessons
              </h4>
              <ul class="custom-reading-list" id="custom-reading-list"></ul>
              <small class="subtle"
                >Use the × button beside any item to remove it from the
                tracker.</small
              >
            </div>
            <div class="form-actions">
              <button
                class="primary"
                type="button"
                data-action="reset-readings"
              >
                Reset Reading Progress
              </button>
              <button
                class="link-button"
                type="button"
                data-action="clear-custom-readings"
              >
                Remove custom readings
              </button>
            </div>
          </div>
        </div>
      </section>

      <section id="practice">
        <div class="flex-between">
          <h2>Practice Sessions</h2>
          <div class="subtle">
            Tip: add a reflection note after each session to build habits.
          </div>
        </div>
        <div class="cards two">
          <div class="card">
            <div class="tracker-list" id="practice-list"></div>
          </div>
        </div>
      </section>
      <section id="notes">
        <div class="flex-between">
          <h2>Notes Journal</h2>
          <p class="subtle">
            Capture reflections after each study or practice block.
          </p>
        </div>
        <div class="cards two notes-grid">
          <div class="card notes-card">
            <h3 style="font-size: 1.1rem; font-weight: 700">New entry</h3>
            <p class="subtle" style="margin-top: 0.5rem">
              We'll timestamp and save each note on this device only.
            </p>
            <form id="note-form" class="note-form" novalidate>
              <div class="field">
                <label for="note-text">Reflection</label>
                <textarea
                  id="note-text"
                  name="note"
                  rows="6"
                  required
                  placeholder="Record key learnings, machines used, fit-up issues, etc."
                ></textarea>
              </div>
              <p class="form-error" data-note-error hidden role="alert"></p>
              <div class="actions">
                <button type="reset" class="secondary">Clear</button>
                <button type="submit">Save journal entry</button>
              </div>
            </form>
          </div>
          <div class="card notes-history">
            <div
              class="flex-between"
              style="gap: 1rem; align-items: flex-start"
            >
              <div>
                <h3 style="font-size: 1.1rem; font-weight: 700">
                  Stored notes
                </h3>
                <p class="subtle" style="margin-top: 0.35rem">
                  Entries are ordered with the most recent first.
                </p>
              </div>
              <button
                class="link-button"
                type="button"
                data-action="clear-notes"
              >
                Clear all
              </button>
            </div>
            <p class="subtle" data-empty-notes style="margin-top: 1rem">
              No notes saved yet. Add your first reflection to build your log.
            </p>
            <ul class="notes-list" id="notes-list"></ul>
          </div>
        </div>
      </section>
    </main>

    <footer>
      Built for the self-paced welder: use the tracker weekly to keep your
      practice intentional.
    </footer>

    <template id="tracker-item-template">
      <div class="tracker-item" data-state="pending">
        <input class="toggle" type="checkbox" />
        <div class="tracker-content">
          <h3></h3>
          <p></p>
          <div class="tags" hidden></div>
        </div>
        <span class="badge"></span>
        <button
          class="remove-item"
          type="button"
          hidden
          aria-label="Remove custom item"
        >
          ×
        </button>
      </div>
    </template>

    <script>
      const trackerData = {
        readings: [
          {
            id: "mig-basics",
            title: "Intro to MIG Welding Parameters",
            description:
              "Voltage, wire feed speed, contact tip to work distance",
            category: "process",
            link: "https://weldingtipsandtricks.com/mig-welding-basics.html",
            type: "Article",
            tags: ["process", "setup"],
          },
          {
            id: "safety-gear",
            title: "Personal Protective Equipment Checklist",
            description: "Helmet shade charts, gloves, jacket ratings",
            category: "safety",
            link: "https://www.lincolnelectric.com/en-us/support/welding-safety/Pages/welding-safety-gear.aspx",
            type: "Guide",
            tags: ["safety"],
          },
          {
            id: "joint-prep",
            title: "Preparing Joints for Strong Welds",
            description:
              "Cleaning, bevels, root gap, and fit-up for mild steel",
            category: "process",
            link: "https://www.millerwelds.com/resource/articles/welding-joint-preparation",
            type: "Article",
            tags: ["process", "fit-up"],
          },
          {
            id: "metallurgy",
            title: "Metallurgy Basics for Fabrication",
            description:
              "How heat-affected zones behave and why cooling matters",
            category: "theory",
            link: "https://materials.openstax.org/books/introduction-to-materials-science",
            type: "Chapter",
            tags: ["theory"],
          },
          {
            id: "symbols",
            title: "Reading Welding Symbols",
            description:
              "Blueprint interpretation essentials for fabrication drawings",
            category: "theory",
            link: "https://www.thefabricator.com/thefabricator/article/shopmanagement/welding-symbols-demystified",
            type: "Article",
            tags: ["theory", "blueprint"],
          },
          {
            id: "safety-ventilation",
            title: "Ventilation & Fume Safety",
            description:
              "Airflow strategies and respirator selection for indoor bays",
            category: "safety",
            link: "https://www.osha.gov/sites/default/files/publications/welding.pdf",
            type: "PDF",
            tags: ["safety", "environment"],
          },
        ],
        practice: [
          {
            id: "pads-of-beads",
            title: "Pads of Beads",
            description:
              "Run five steady beads focusing on travel speed and gun angle.",
            focus: "Fundamentals",
          },
          {
            id: "lap-joint",
            title: "Lap Joint Fillets",
            description:
              'Three 3" coupons, horizontal position, evaluate for undercut.',
            focus: "Positioning",
          },
          {
            id: "t-joint",
            title: "T-Joint Fillets",
            description: "Practice pushing vs pulling to compare penetration.",
            focus: "Technique",
          },
          {
            id: "butt-joint",
            title: "Butt Joint Root Pass",
            description:
              '1/8" plate with 1/16" gap, monitor heat input and tie-in.',
            focus: "Heat control",
          },
          {
            id: "fabrication-mini",
            title: "Mini Fabrication Project",
            description:
              "Assemble a small frame or rack; track prep, tack, and final welds.",
            focus: "Project",
          },
          {
            id: "cleanup",
            title: "Cleanup & Inspection",
            description:
              "Grind, wire brush, and photograph your best weld for review.",
            focus: "Quality",
          },
        ],
      };

      const CUSTOM_READING_KEY = "custom-readings";
      const NOTES_KEY = "welding-note-entries";

      function loadCustomReadings() {
        try {
          const stored = JSON.parse(
            localStorage.getItem(CUSTOM_READING_KEY) || "[]",
          );
          return Array.isArray(stored) ? stored : [];
        } catch (error) {
          console.warn("Unable to parse saved readings", error);
          return [];
        }
      }

      function loadNotes() {
        try {
          const stored = JSON.parse(localStorage.getItem(NOTES_KEY) || "[]");
          let notes = Array.isArray(stored)
            ? stored.filter(
                (note) =>
                  note &&
                  typeof note.id === "string" &&
                  typeof note.body === "string" &&
                  typeof note.createdAt === "string",
              )
            : [];

          const legacy = localStorage.getItem("welding-notes");
          if (legacy && legacy.trim()) {
            notes.unshift({
              id: `legacy-${Date.now()}`,
              body: legacy.trim(),
              createdAt: new Date().toISOString(),
            });
            localStorage.removeItem("welding-notes");
            localStorage.setItem(NOTES_KEY, JSON.stringify(notes));
          }

          return notes.sort(
            (a, b) => new Date(b.createdAt) - new Date(a.createdAt),
          );
        } catch (error) {
          console.warn("Unable to parse saved notes", error);
          return [];
        }
      }

      const templates = {
        tracker: document.getElementById("tracker-item-template"),
      };

      const state = {
        readings: JSON.parse(localStorage.getItem("reading-progress") || "{}"),
        practice: JSON.parse(localStorage.getItem("practice-progress") || "{}"),
        notes: loadNotes(),
        streak: JSON.parse(
          localStorage.getItem("welding-streak") || '{"count":0,"date":null}',
        ),
        customReadings: loadCustomReadings(),
      };

      const readingListEl = document.getElementById("reading-list");
      const practiceListEl = document.getElementById("practice-list");
      const readingCountEl = document.getElementById("reading-count");
      const practiceCountEl = document.getElementById("practice-count");
      const readingBarEl = document.getElementById("reading-bar");
      const practiceBarEl = document.getElementById("practice-bar");
      const overallPercentageEl = document.getElementById("overall-percentage");
      const streakCountEl = document.getElementById("streak-count");
      const noteForm = document.getElementById("note-form");
      const noteField = document.getElementById("note-text");
      const noteError = document.querySelector("[data-note-error]");
      const notesListEl = document.getElementById("notes-list");
      const emptyNotesEl = document.querySelector("[data-empty-notes]");
      const readingFilterEl = document.getElementById("reading-filter");
      const addReadingForm = document.getElementById("add-reading-form");
      const customSummaryEl = document.getElementById("custom-reading-summary");
      const customListEl = document.getElementById("custom-reading-list");

      const circle = document.querySelector(
        ".progress-ring circle:nth-of-type(2)",
      );
      const circumference = 2 * Math.PI * 52;

      const formatPercent = (value) => `${Math.round(value * 100)}%`;
      const formatDateTime = (value) => {
        try {
          return new Intl.DateTimeFormat(undefined, {
            dateStyle: "medium",
            timeStyle: "short",
          }).format(new Date(value));
        } catch (error) {
          return value;
        }
      };

      const getReadingItems = () => [
        ...trackerData.readings,
        ...state.customReadings,
      ];

      function saveCustomReadings() {
        localStorage.setItem(
          CUSTOM_READING_KEY,
          JSON.stringify(state.customReadings),
        );
      }

      function saveNotes() {
        localStorage.setItem(NOTES_KEY, JSON.stringify(state.notes));
      }

      function updateStreak(completedToday) {
        const today = new Date().toISOString().slice(0, 10);
        let { count, date } = state.streak;

        if (completedToday) {
          if (date === today) {
            // already counted today
            return;
          }

          const yesterday = new Date(Date.now() - 86400000)
            .toISOString()
            .slice(0, 10);
          if (date === yesterday) {
            count += 1;
          } else {
            count = 1;
          }

          state.streak = { count, date: today };
          localStorage.setItem("welding-streak", JSON.stringify(state.streak));
        }

        streakCountEl.textContent = `${state.streak.count || 0} ${state.streak.count === 1 ? "day" : "days"}`;
      }

      function renderTracker(list, target, type) {
        const progressKey = type === "reading" ? "readings" : type;
        const progressState = state[progressKey] || {};
        const fragment = document.createDocumentFragment();

        list.forEach((item) => {
          const node = templates.tracker.content.cloneNode(true);
          const wrapper = node.querySelector(".tracker-item");
          const checkbox = node.querySelector(".toggle");
          const content = node.querySelector(".tracker-content");
          const titleEl = node.querySelector("h3");
          const descriptionEl = node.querySelector("p");
          const badgeEl = node.querySelector(".badge");
          const tagsEl = node.querySelector(".tags");
          const removeButton = node.querySelector(".remove-item");

          const isComplete = Boolean(progressState[item.id]);
          checkbox.checked = isComplete;
          checkbox.id = `${type}-${item.id}`;
          wrapper.dataset.state = isComplete ? "done" : "pending";

          const badgeLabel =
            type === "reading"
              ? item.type || item.category || "Resource"
              : item.focus || "";
          badgeEl.textContent = badgeLabel;

          descriptionEl.textContent = item.description || "";
          descriptionEl.hidden = !item.description;

          if (tagsEl) {
            tagsEl.innerHTML = "";
            const tagValues = new Set();
            if (item.tags && item.tags.length) {
              item.tags.forEach((tag) => tag && tagValues.add(tag));
            }
            if (type === "reading" && item.category) {
              tagValues.add(item.category);
            }

            if (tagValues.size) {
              tagsEl.hidden = false;
              tagValues.forEach((tag) => {
                const span = document.createElement("span");
                span.className = "tag";
                span.textContent = tag;
                tagsEl.appendChild(span);
              });
            } else {
              tagsEl.hidden = true;
            }
          }

          titleEl.textContent = "";
          if (item.link) {
            const anchor = document.createElement("a");
            anchor.href = item.link;
            anchor.target = "_blank";
            anchor.rel = "noopener";
            anchor.className = "resource-link";
            anchor.innerHTML = `${item.title} <span>↗</span>`;
            titleEl.appendChild(anchor);
          } else {
            titleEl.textContent = item.title;
          }

          if (type === "reading") {
            const filters = new Set();
            const pushFilter = (value) => {
              if (value) filters.add(String(value).toLowerCase());
            };

            pushFilter(item.category);
            pushFilter(item.type);
            if (item.tags && item.tags.length) {
              item.tags.forEach((tag) => pushFilter(tag));
            }

            wrapper.dataset.filters = Array.from(filters).join(",");
            wrapper.dataset.itemId = item.id;
            wrapper.dataset.origin = item.origin || "default";

            if (
              item.origin === "custom" ||
              String(item.id).startsWith("custom-")
            ) {
              removeButton.hidden = false;
              removeButton.addEventListener("click", (event) => {
                event.stopPropagation();
                removeCustomReading(item.id);
              });
            } else {
              removeButton.remove();
            }
          } else {
            removeButton.remove();
          }

          checkbox.addEventListener("change", () => {
            state[progressKey][item.id] = checkbox.checked;
            localStorage.setItem(
              `${type}-progress`,
              JSON.stringify(state[progressKey]),
            );
            wrapper.dataset.state = checkbox.checked ? "done" : "pending";
            updateProgress();
            updateStreak(type === "practice" && checkbox.checked);
          });

          if (content) {
            content.addEventListener("click", (event) => {
              if (event.target.closest("a")) return;
              checkbox.checked = !checkbox.checked;
              checkbox.dispatchEvent(new Event("change", { bubbles: true }));
            });
          }

          fragment.appendChild(node);
        });

        target.innerHTML = "";
        target.appendChild(fragment);
      }

      function updateProgress() {
        const readingItems = getReadingItems();
        const readingTotal = readingItems.length;
        const practiceTotal = trackerData.practice.length;
        const readingDone = readingItems.filter((item) =>
          Boolean(state.readings[item.id]),
        ).length;
        const practiceDone = Object.values(state.practice).filter(
          Boolean,
        ).length;

        const readingFraction = readingTotal ? readingDone / readingTotal : 0;
        const practiceFraction = practiceTotal
          ? practiceDone / practiceTotal
          : 0;
        const overall =
          readingTotal + practiceTotal
            ? (readingDone + practiceDone) / (readingTotal + practiceTotal)
            : 0;

        readingCountEl.textContent = formatPercent(readingFraction);
        practiceCountEl.textContent = formatPercent(practiceFraction);
        readingBarEl.style.width = `${readingFraction * 100}%`;
        practiceBarEl.style.width = `${practiceFraction * 100}%`;
        overallPercentageEl.textContent = formatPercent(overall);
        const offset = circumference - overall * circumference;
        circle.style.strokeDasharray = circumference;
        circle.style.strokeDashoffset = offset;
      }

      function collectReadingFilters() {
        const filters = new Set();
        getReadingItems().forEach((item) => {
          if (item.category) filters.add(item.category.toLowerCase());
          if (item.type) filters.add(item.type.toLowerCase());
          if (item.tags && item.tags.length) {
            item.tags.forEach((tag) => filters.add(tag.toLowerCase()));
          }
        });
        return Array.from(filters).sort();
      }

      function populateReadingFilters() {
        if (!readingFilterEl) return;
        const currentValue = readingFilterEl.value || "all";
        const filters = ["all", ...collectReadingFilters()];
        readingFilterEl.innerHTML = "";

        filters.forEach((filter) => {
          const option = document.createElement("option");
          option.value = filter;
          option.textContent =
            filter === "all"
              ? "Show everything"
              : filter.replace(/\b\w/g, (char) => char.toUpperCase());
          readingFilterEl.appendChild(option);
        });

        if (filters.includes(currentValue)) {
          readingFilterEl.value = currentValue;
        } else {
          readingFilterEl.value = "all";
        }
      }

      function applyReadingFilter() {
        if (!readingFilterEl) return;
        const filter = readingFilterEl.value;
        const emptyMessage = document.querySelector("#reading .empty-message");
        let visibleCount = 0;

        readingListEl.querySelectorAll(".tracker-item").forEach((itemEl) => {
          if (filter === "all") {
            itemEl.hidden = false;
            visibleCount += 1;
            return;
          }

          const filters = (itemEl.dataset.filters || "")
            .split(",")
            .filter(Boolean);
          const matches = filters.includes(filter);
          itemEl.hidden = !matches;
          if (matches) visibleCount += 1;
        });

        emptyMessage.hidden = visibleCount !== 0;
      }

      function bindReadingFilter() {
        if (!readingFilterEl) return;
        readingFilterEl.addEventListener("change", applyReadingFilter);
      }

      function updateCustomSummary() {
        if (!customSummaryEl || !customListEl) return;
        const hasCustom = state.customReadings.length > 0;
        customSummaryEl.hidden = !hasCustom;

        if (!hasCustom) {
          customListEl.innerHTML = "";
          return;
        }

        customListEl.innerHTML = "";
        state.customReadings.forEach((item) => {
          const li = document.createElement("li");
          li.textContent = item.title;
          customListEl.appendChild(li);
        });
      }

      function renderReadingSection() {
        renderTracker(getReadingItems(), readingListEl, "reading");
        populateReadingFilters();
        applyReadingFilter();
        updateCustomSummary();
        updateProgress();
      }

      function renderNotes() {
        if (!notesListEl || !emptyNotesEl) return;
        notesListEl.innerHTML = "";

        const hasNotes = state.notes.length > 0;
        emptyNotesEl.hidden = hasNotes;

        if (!hasNotes) {
          return;
        }

        state.notes.forEach((note) => {
          const item = document.createElement("li");
          item.className = "note-entry";

          const header = document.createElement("header");
          const timeEl = document.createElement("time");
          timeEl.dateTime = note.createdAt;
          timeEl.textContent = formatDateTime(note.createdAt);
          header.appendChild(timeEl);

          const removeButton = document.createElement("button");
          removeButton.type = "button";
          removeButton.textContent = "Remove";
          removeButton.dataset.noteId = note.id;
          removeButton.setAttribute("data-note-remove", note.id);
          header.appendChild(removeButton);

          const body = document.createElement("p");
          body.textContent = note.body;

          item.appendChild(header);
          item.appendChild(body);
          notesListEl.appendChild(item);
        });
      }

      function removeCustomReading(id) {
        state.customReadings = state.customReadings.filter(
          (item) => item.id !== id,
        );
        delete state.readings[id];
        saveCustomReadings();
        localStorage.setItem(
          "reading-progress",
          JSON.stringify(state.readings),
        );
        renderReadingSection();
      }

      function bindAddReadingForm() {
        if (!addReadingForm) return;
        const errorEl = addReadingForm.querySelector("[data-form-error]");
        const showFormError = (message) => {
          if (!errorEl) return;
          errorEl.textContent = message || "";
          errorEl.hidden = !message;
        };

        const formatCategory = (value) =>
          value
            ? value
                .split(/\s+/)
                .map((word) => word.charAt(0).toUpperCase() + word.slice(1))
                .join(" ")
            : "";

        addReadingForm.addEventListener("submit", (event) => {
          event.preventDefault();
          showFormError("");

          const formData = new FormData(addReadingForm);
          const title = (formData.get("title") || "").trim();
          let link = (formData.get("link") || "").trim();
          const description = (formData.get("description") || "").trim();
          const categoryInput = (formData.get("category") || "").trim();

          if (!title) {
            showFormError("Add a lesson title to continue.");
            return;
          }

          if (!link) {
            showFormError("Paste the lesson link so we can save it.");
            return;
          }

          if (!/^([a-z][a-z0-9+.-]*:)/i.test(link)) {
            link = `https://${link.replace(/^\/+/, "")}`;
          }

          try {
            link = new URL(link).toString();
          } catch (error) {
            showFormError(
              "That link doesn't look valid. Try adding the full URL.",
            );
            return;
          }

          const category = formatCategory(categoryInput);
          const tags = categoryInput
            ? Array.from(
                new Set(
                  [categoryInput, category, categoryInput.toLowerCase()].filter(
                    Boolean,
                  ),
                ),
              )
            : [];

          const normalizedTitle = title.toLowerCase();
          const duplicate = getReadingItems().some((item) => {
            const titleMatch =
              (item.title || "").trim().toLowerCase() === normalizedTitle;
            const linkMatch = item.link && item.link === link;
            return titleMatch || linkMatch;
          });

          if (duplicate) {
            showFormError("That lesson is already on your checklist.");
            return;
          }

          const customItem = {
            id: `custom-${Date.now()}`,
            title,
            link,
            description,
            category,
            type: category || "Custom",
            origin: "custom",
            tags,
          };

          state.customReadings.push(customItem);
          saveCustomReadings();
          addReadingForm.reset();
          const titleField = addReadingForm.querySelector('[name="title"]');
          if (titleField) {
            titleField.focus();
          }
          showFormError("");
          renderReadingSection();
        });
      }

      function bindClearCustomReadings() {
        const clearButton = document.querySelector(
          '[data-action="clear-custom-readings"]',
        );
        if (!clearButton) return;
        clearButton.addEventListener("click", () => {
          if (!state.customReadings.length) {
            return;
          }
          state.customReadings = [];
          saveCustomReadings();
          const keys = Object.keys(state.readings);
          keys.forEach((key) => {
            if (key.startsWith("custom-")) {
              delete state.readings[key];
            }
          });
          localStorage.setItem(
            "reading-progress",
            JSON.stringify(state.readings),
          );
          renderReadingSection();
        });
      }

      function bindNotes() {
        if (!noteForm || !noteField || !notesListEl) return;

        const showNoteError = (message) => {
          if (!noteError) return;
          noteError.textContent = message || "";
          noteError.hidden = !message;
        };

        renderNotes();

        noteForm.addEventListener("submit", (event) => {
          event.preventDefault();
          const body = noteField.value.trim();

          if (!body) {
            showNoteError("Add a reflection before saving.");
            noteField.focus();
            return;
          }

          const note = {
            id: `note-${Date.now()}`,
            body,
            createdAt: new Date().toISOString(),
          };

          state.notes.unshift(note);
          saveNotes();
          renderNotes();
          noteForm.reset();
          showNoteError("");
          noteField.focus();
        });

        noteForm.addEventListener("reset", () => {
          showNoteError("");
        });

        notesListEl.addEventListener("click", (event) => {
          const button = event.target.closest("[data-note-remove]");
          if (!button) return;
          const { noteId } = button.dataset;
          if (!noteId) return;

          state.notes = state.notes.filter((note) => note.id !== noteId);
          saveNotes();
          renderNotes();
        });

        const clearButton = document.querySelector(
          '[data-action="clear-notes"]',
        );
        if (clearButton) {
          clearButton.addEventListener("click", () => {
            if (!state.notes.length) {
              return;
            }
            state.notes = [];
            saveNotes();
            renderNotes();
          });
        }
      }

      function bindResets() {
        document
          .querySelectorAll('[data-action="reset-readings"]')
          .forEach((button) => {
            button.addEventListener("click", () => {
              state.readings = {};
              localStorage.removeItem("reading-progress");
              renderReadingSection();
            });
          });
      }

      function initializeReadingList() {
        if (!state.readings) {
          state.readings = {};
        }
        renderReadingSection();
      }

      initializeReadingList();
      renderTracker(trackerData.practice, practiceListEl, "practice");
      bindReadingFilter();
      bindAddReadingForm();
      bindClearCustomReadings();
      bindNotes();
      bindResets();
      updateProgress();
      updateStreak(false);
    </script>
  </body>
</html>
